import 'dart:convert';
import 'dart:io';

import 'package:archive/archive_io.dart';
import 'package:metar/metar.dart';
import 'package:test/test.dart';

const String metarsDirPath = 'test/integration/artifacts/metars';

Iterable<File> listMetars(String path) {
  final dir = Directory(path);
  if (!dir.existsSync()) {
    return Iterable.empty();
  }
  final List<FileSystemEntity> entities = dir.listSync();
  return entities.whereType<File>().where((file) => file.path.endsWith('.bz2'));
}

String decode(String path) {
  final inputStream = InputFileStream(path);
  final archive = BZip2Decoder().decodeBuffer(inputStream);
  return utf8.decode(archive);
}

void createTest(int number, String metar) {
  test('Test ${number.toString().padLeft(5, '0')}: `$metar`', () {
    String bodyRaw = metar.split(' RMK')[0];
    String bodyProcessed = Metar(metar).body.toString();

    expect(bodyRaw, bodyProcessed, reason: '`$metar`');
  });
}

void createTestGroup(File file) {
  // Double-split to cover both Windows/Unix path manipulations
  String fileName = file.path.split('/').last.split('\\').last;
  String groupName = fileName.split('.').first;
  var ignoredMetars = brokenMetars(groupName);
  group('$groupName', () {
    List<String> lines = decode(file.path).split('\n');
    for (int i = 0; i < lines.length; ++i) {
      if (lines[i].isNotEmpty && !ignoredMetars.contains(lines[i])) {
        createTest(i, lines[i]);
      }
    }
  });
}

void main() {
  group('BodyIntegration', () {
    listMetars(metarsDirPath).forEach((file) {
      createTestGroup(file);
    });
  });
}

List<String> brokenMetars(String key) {
  const katl2021 = <String>[
    // Unrecognizable 'B' keyword in Body section
    r'METAR KATL 091652Z 31010KT 10SM -RA SCT030CB BKN040TCU B 29/22 A3012 RMK AO2 RAB48 SLP189 CB SE MOV SE TCU OHD AND ALQDS P0000 T02890222 $',
    r'SPECI KATL 091721Z 27009G15KT 10SM TS SCT030CB SCT040TCU B 31/22 A3011 RMK AO2 LTG DSNT W-NE RAE02 TSB21 FRQ LTGICCGCA SE TS SE MOV SE CB DSNT NE W NW TCU SE-SW P0000 T03110222 $',
    r'SPECI KATL 091807Z 25011G17KT 10SM TS SCT034CB SCT045TCU B 32/22 A3009 RMK AO2 LTG DSNT NW-NE TSB07 FRQ LTGICCGCA NW-N TS NW-N MOV SE CB DSNT N SE NW TCU SW-W T03170217 $',
    r'METAR KATL 091852Z 33013G20KT 10SM TS SCT036CB BKN048TCU B 30/21 A3010 RMK AO2 LTG DSNT NW-E TSB07 SLP181 FRQ LTGICCGCA NW-NE TS NW-NE MOV SE CB DSNT ALQDS TCU ALQDS SHELF COUD NE MOV SE SHRA NW-NE T03000211 $',
    r'SPECI KATL 091905Z 33009KT 10SM TS SCT036CB BKN044TCU B 27/21 A3010 RMK AO2 WSHFT 1849 LTG DSNT NW-E OCNL LTGICCGCA N-E VC NW TS N-E VC NW MOV SE CB DSNT ALQDS TCU E-S-SW SHRA N-E VC NW T02720211 $',
    r'METAR KATL 141852Z 00000KT 10SM -RA FEW036CB SCT046TCU B 25/22 A3026 RMK AO2 PK WND 21028/1813 RAB19 SLP240 CB NE MOV NE TCU N-E DSNT ALQDS P0007 T02500217',
    r'METAR KATL 201752Z VRB03KT 10SM SCT022CB BKN032TCU B 27/21 A2999 RMK AO2 SLP145 VIS LWR NW-NE CB NW-NE MOV E TCU ALQDS SHRA NW-NE T02720211 10283 20222 58004',
    r'SPECI KATL 201802Z 32012G15KT 8SM -RA SCT022CB BKN032TCU B 26/21 A2999 RMK AO2 RAB01 VIS LWR NW-NE CB NW-NE MOV E TCU ALQDS P0000 T02610211',
    r'SPECI KATL 102040Z 21007KT 10SM TS SCT042CB SCT050TCU B 32/22 A3016 RMK AO2 LTG DSNT E-SW TSB36 OCNL LTGICCG NE-E TS NE-E MOV NE CB DSNT E-S-SW TCU ALQDS T03220222',
    r'METAR KATL 102052Z 20009KT 10SM VCTS SCT043CB SCT050TCU B 32/22 A3015 RMK AO2 LTG DSNT E-SW SLP199 TSB36 OCNL LTGICCA VC SE S TS VC SE S MOV N CB DSNT E-S-SW TCU ALQDS T03220222 56016 )',
    r'METAR KATL 111652Z 24004KT 10SM BKN032CB BKN040TCU B 31/22 A3020 RMK AO2 LTG DSNT SW SLP217 CB OHD-SE MOV STNRY TCU ALQDS CB DSNT SW SHRA SE T03060222',
    r'SPECI KATL 111709Z 14006KT 8SM -RA BKN032CB BKN040TCU B 29/22 A3019 RMK AO2 LTG DSNT NE RAB08 VIS LWR NE-SE CB NE-SE MOV STNRY TCU ALQDS CB DSNT NE P0000 T02940217',
    r'SPECI KATL 111719Z 12006KT 8SM -TSRA BKN032CB BKN040TCU B 28/23 A3019 RMK AO2 LTG DSNT NE AND E RAB08 TSB18 VIS LWR NE-SE OCNL LTGICCA NE-SE TS NE-SE MOV STNRY CB DSNT NE E TCU ALQDS P0000 T02830228',
    r'SPECI KATL 301935Z 12013G26KT 3/4SM R09R/5000VP6000FT RA BKN034CB BKN042TCU B 24/21 A2997 RMK AO2 PK WND 14026/1927 SFC VIS 2 LTG DSNT SE AND NW CB OHD-NE-SE MOV NW CB DSNT SE NW TCU ALQDS P0011 T02440211',
    r'SPECI KATL 301938Z 10010G21KT 4SM R09R/5000VP6000FT -TSRA BKN034CB BKN042TCU B 24/21 A2996 RMK AO2 PK WND 14026/1927 LTG DSNT E AND SE AND NW TSB37 OCNL LTGICCA NE-E TS NE-E MOV NW CB DSNT SE NW TCU ALQDS P0011 T02440211',
    r'METAR KATL 071752Z 11006KT 6SM -RA FEW028CB SCT038TCU B 26/22 A3001 RMK AO2 RAB15 SLP151 VIS LWR SE-S CB SE-S MOV NE TCU N-NE SE SW P0011 60012 T02610217 10294 20228 58009',
    r'METAR KATL 211752Z 05005KT 10SM SCT018CB BKN028TCU B 27/22 A3009 RMK AO2 SLP180 CB SE MOV E TCU ALQDS SHRA E-SE 60000 T02670217 10267 20222 58007',
    r'METAR KATL 212152Z 10010KT 10SM -RA SCT018CB BKN025TCU B 26/22 A3003 RMK AO2 RAB32 SLP159 CB E-SE MOV STNRY TCU OHD-ALQDS P0003 T02610222',
    // Unrecognizable 'S' keyword in Body section
    r'SPECI KATL 102150Z 04005KT 10SM VCTS FEW035CB SCT050TCU S 28/21 A3005 RMK AO2 LTG DSNT NW TSE49 OCNL LTGICCG NW-NE TS NW-NE MOV E TCU E & S & SW SHRA E & S & SW FIBI',
    r'METAR KATL 102152Z 04005KT 10SM VCTS FEW035CB SCT050TCU S 28/21 A3005 RMK AO2 TSE49 SLP167 OCNL LTGICCG VC NW-NE TS VC NW-NE MOV E TCU E-SE & S-SW SHRA E-SE & S-SW T02830211 PS)',
    r'SPECI KATL 110007Z 21011G21KT 10SM TS FEW032CB SCT060TCU S 25/22 A3006 RMK AO2 RAE1858 TSB05 OCNL LTGIC S-SW TS S-SW MOV NE TCU SW & DSNT N CB DSNT NW P0000 T02500217 $',
    r'SPECI KATL 110021Z 15008G22KT 7SM R09R/2200V6000FT -TSRA FEW032CB SCT060TCU S 23/21 A3005 RMK A02 PK WND 23028/0010 RAB14 TSB05 OCNL LTGIC OHD-S-SW TS OHD-S-SW MOV NE VIS S-W 1 1/4 TCU DSNT NW P0021 T02330206 T02330 $',
    r'METAR KATL 141752Z 23007KT 10SM FEW036CB SCT044TCU S 29/19 A3027 RMK AO2 LTG DSNT NE SLP241 CB SW DSNT NE SW MOV NE TCU ALQDS SHRA SW DSNT NE T02940189 10311 20233 58010',
    // Unrecognizable '2//21' keyword in Body section
    r'METAR KATL 281452Z 18007KT 10SM SCT010 2//21 A2991 RMK AO2 RAB23E35 SLP123 CIG 013V017 P0000 60000 T02000172 10200 20178 58020',
    // Unreported wind group values before 'KT' keyword in Body section
    r'SPECI KATL 221447Z KT 10SM SCT012 SCT026 26/23 A2999 RMK AO2 $',
  ];

  const kgtf2021 = <String>[
    // Unreported wind group empty values before 'KT' keyword in Body section
    r'METAR KGTF 272053Z KT 10SM OVC070 00/M11 A2973 RMK AO2 SLP119 T00001106 56006 $',
    r'METAR KGTF 100053Z KT 10SM CLR M28/M32 A3016 RMK AO2 SLP339 T12831322 $',
    r'METAR KGTF 162053Z KT 10SM SCT060 09/M05 A3033 RMK AO2 SLP299 T00941050 58008 $',
    r'METAR KGTF 201853Z KT 10SM BKN065 05/M07 A3032 RMK AO2 SLP304 T00501072 $',
    r'SPECI KGTF 232249Z KT 10SM BKN031 OVC075 02/M04 A2995 RMK AO2 $',
    r'METAR KGTF 252053Z KT 10SM BKN020 07/02 A2965 RMK AO2 SLP062 60000 T00720017 56009 $',
    r'METAR KGTF 052153Z KT 10SM FEW060 FEW075 14/M01 A3024 RMK AO2 SLP250 T01391006 $',
    r'METAR KGTF 132053Z KT 10SM -RA FEW037 BKN080 OVC100 18/04 A3010 RMK AO2 RAB45 SLP185 P0000 60000 T01780044 55002',
    r'METAR KGTF 151753Z KT 10SM CLR 18/03 A3004 RMK AO2 SLP165 T01780028 10183 20033 58005',
    r'METAR KGTF 162253Z KT 10SM CLR 24/M01 A2990 RMK AO2 SLP113 T02391006',
    r'METAR KGTF 292253Z KT 10SM CLR 18/M04 A3012 RMK AO2 SLP204 T01831044 $',
    r'METAR KGTF 081953Z KT 10SM CLR 19/02 A2990 RMK AO2 SLP110 T01890017 $',
    r'METAR KGTF 101853Z KT 10SM BKN042 18/06 A2978 RMK AO2 SLP069 T01830061 $',
    r'METAR KGTF 141853Z KT 10SM CLR 31/11 A2993 RMK AO2 SLP103 T03060111 $',
    r'METAR KGTF 241653Z KT 10SM SCT095 BKN110 23/09 A2998 RMK AO2 SLP124 T02330089 $',
    r'METAR KGTF 260753Z KT 0p0?K f S CLR 13/09 A3014 RMK AO2 SLP186 T01280089 $',
    r'METAR KGTF 281853Z KT 10SM CLR 29/09 A3019 RMK AO2 SLP190 T02940089 $',
    r'METAR KGTF 292153Z KT 10SM CLR 34/07 A3008 RMK AO2 SLP152 T03390072 $',
    r'METAR KGTF 022253Z KT 10SM FEW110 36/07 A2987 RMK AO2 SLP071 T03610072 $',
    r'METAR KGTF 041853Z KT 10SM CLR 33/07 A2993 RMK AO2 SLP092 T03330067 $',
    r'METAR KGTF 042053Z KT 10SM CLR 35/04 A2990 RMK AO2 SLP083 T03500039 56014 $',
    r'METAR KGTF 051953Z KT 10SM CLR 24/11 A3016 RMK AO2 SLP187 T02440111 $',
    r'METAR KGTF 082153Z KT 10SM CLR 27/08 A2996 RMK AO2 SLP117 T02720083 $',
    r'METAR KGTF 092253Z KT 10SM CLR 30/02 A3012 RMK AO2 RAE05 SLP174 P0000 T03000022 $',
    r'METAR KGTF 112153Z KT 7SM CLR 32/04 A3000 RMK AO2 SLP122 T03170044 $',
    r'METAR KGTF 162153Z KT 5SM HZ CLR 31/03 A2992 RMK AO2 SLP100 T03110028 $',
    r'METAR KGTF 172253Z KT 5SM HZ CLR 33/03 A3001 RMK AO2 SLP125 T03330033 $',
    r'METAR KGTF 191853Z KT 6SM HZ CLR 27/14 A3014 RMK AO2 SLP174 T02720139 $',
    r'METAR KGTF 201953Z KT 10SM CLR 31/11 A3002 RMK AO2 SLP128 T03060111 $',
    r'METAR KGTF 202153Z KT 9SM CLR 33/11 A2998 RMK AO2 SLP112 T03330106 $',
    r'METAR KGTF 202253Z KT 9SM CLR 33/11 A2997 RMK AO2 SLP109 T03330106 $',
    r'METAR KGTF 211753Z KT 10SM CLR 28/11 A3000 RMK AO2 SLP120 T02830106 10294 20172 58004 $',
    r'METAR KGTF 221953Z KT 10SM CLR 32/09 A2994 RMK AO2 SLP101 T03170089 $',
    r'METAR KGTF 222053Z KT 9SM CLR 33/05 A2992 RMK AO2 SLP096 T03330050 58013 $',
    r'METAR KGTF 222153Z KT 10SM CLR 33/06 A2992 RMK AO2 SLP095 T03330056 $',
    r'METAR KGTF 222253Z KT 10SM CLR 33/02 A2992 RMK AO2 SLP094 T03280022 $',
    r'METAR KGTF 242253Z KT 4SM HZ SCT043 32/M01 A3008 RMK AO2 SLP157 T03171011 $',
    r'METAR KGTF 281653Z KT 10SM CLR 27/10 A3023 RMK AO2 SLP200 T02720100 $',
    r'METAR KGTF 290353Z KT 8SM CLR 24/07 A3013 RMK AO2 SLP168 T02440072 $',
    r'METAR KGTF 290453Z KT 8SM CLR 23/07 A3014 RMK AO2 SLP170 T02280072 $',
    r'METAR KGTF 290553Z KT 8SM CLR 23/08 A3014 RMK AO2 SLP168 T02280078 10322 20217 51006 $',
    r'METAR KGTF 290653Z KT 9SM CLR 18/09 A3014 RMK AO2 SLP173 T01830089 403330178 $',
    r'METAR KGTF 290753Z KT 9SM CLR 19/09 A3014 RMK AO2 SLP172 T01890089 $',
    r'METAR KGTF 290853Z KT 9SM CLR 19/09 A3014 RMK AO2 SLP169 T01890089 50000 $',
    r'METAR KGTF 290953Z KT 9SM CLR 19/09 A3014 RMK AO2 SLP168 T01940094 $',
    r'METAR KGTF 291153Z KT 6SM -RA FEW090 OVC110 18/14 A3015 RMK AO2 SLP174 P0001 60001 70001 T01780144 10228 20172 53001 $',
    r'METAR KGTF 301953Z KT 10SM CLR 33/08 A3019 RMK AO2 SLP185 T03280083 $',
    r'METAR KGTF 311953Z KT 10SM CLR 32/09 A3026 RMK AO2 SLP205 T03220089 $',
    r'METAR KGTF 312153Z KT 10SM SCT100 34/09 A3022 RMK AO2 SLP195 T03440089 $',
    r'METAR KGTF 012053Z KT 8SM CLR 36/06 A3013 RMK AO2 SLP160 T03560061 58023 $',
    r'SPECI KGTF 031830Z KT 2 1/2SM HZ CLR 28/11 A3013 RMK AO2 SFC VIS 3 T02780111 $',
    r'METAR KGTF 031953Z KT 2 1/2SM HZ CLR 29/11 A3012 RMK AO2 SFC VIS 3 SLP162 T02940106 $',
    r'SPECI KGTF 032025Z KT 4SM HZ CLR 30/08 A3012 RMK AO2 T03000078 $',
    r'METAR KGTF 032053Z KT 4SM HZ CLR 30/08 A3012 RMK AO2 SLP160 T03000078 56007 $',
    r'METAR KGTF 032153Z KT 5SM HZ CLR 32/07 A3010 RMK AO2 SLP152 T03170072 $',
    r'METAR KGTF 040053Z KT 5SM HZ CLR 31/06 A3006 RMK AO2 SLP140 T03110061 $',
    r'METAR KGTF 040353Z KT 6SM HZ CLR 24/09 A3008 RMK AO2 SLP151 T02440094 $',
    r'METAR KGTF 040453Z KT 6SM HZ CLR 23/09 A3008 RMK AO2 SLP151 T02280089 $',
    r'METAR KGTF 040553Z KT 6SM HZ CLR 17/08 A3009 RMK AO2 SLP159 T01670083 10322 20167 51007 $',
    r'METAR KGTF 040653Z KT 7SM CLR 19/06 A3009 RMK AO2 SLP156 T01890061 403280167 $',
    r'METAR KGTF 050453Z KT 9SM FEW110 24/07 A3004 RMK AO2 WSHFT 0345 LTG DSNT NE SLP133 T02390072 $',
    r'METAR KGTF 050553Z KT 9SM CLR 22/08 A3005 RMK AO2 SLP137 60000 T02220078 10306 20222 51010 $',
    r'METAR KGTF 050653Z KT 9SM CLR 21/09 A3007 RMK AO2 SLP143 T02060089 403390150 $',
    r'METAR KGTF 050753Z KT 10SM CLR 19/09 A3008 RMK AO2 SLP147 T01890094 $',
    r'METAR KGTF 050853Z KT 10SM CLR 18/09 A3007 RMK AO2 SLP148 T01830094 50006 $',
    r'METAR KGTF 052053Z KT 8SM CLR 31/07 A2996 RMK AO2 SLP107 T03060072 56019 $',
    r'METAR KGTF 052153Z KT 7SM CLR 32/03 A2993 RMK AO2 SLP099 T03170033 $',
    r'METAR KGTF 052353Z KT 7SM CLR 31/05 A2991 RMK AO2 SLP101 T03060050 10317 20250 56013 $',
    r'SPECI KGTF 060134Z KT 8SM CLR 27/05 A2993 RMK AO2 PRESRR T02670050 $',
    r'SPECI KGTF 060137Z KT 7SM CLR 27/06 A2992 RMK AO2 PRESRR T02670061 $',
    r'METAR KGTF 111753Z KT 10SM CLR 30/07 A2996 RMK AO2 SLP108 T03000072 10306 20156 53002 $',
    r'METAR KGTF 111853Z KT 10SM CLR 31/08 A2995 RMK AO2 SLP105 T03110078 $',
    r'METAR KGTF 111953Z KT 10SM CLR 32/07 A2994 RMK AO2 SLP104 T03170072 $',
    r'METAR KGTF 112053Z KT 10SM CLR 32/07 A2995 RMK AO2 SLP105 T03220072 56003',
    r'METAR KGTF 112353Z KT 10SM CLR 31/09 A2995 RMK AO2 SLP106 T03110089 10339 20300 53002 $',
    r'METAR KGTF 120053Z KT 10SM CLR 29/09 A2996 RMK AO2 SLP112 T02890089 $',
    r'METAR KGTF 122253Z KT 10SM CLR 28/06 A3017 RMK AO2 SLP193 T02780056 $',
    r'METAR KGTF 131853Z KT 10SM CLR 29/05 A3024 RMK AO2 SLP209 T02890050 $',
    r'METAR KGTF 162253Z KT 10SM CLR 35/01 A2974 RMK AO2 PK WND 24030/2157 SLP022 T03500011 $',
    r'METAR KGTF 211853Z KT 10SM SCT110 19/08 A2982 RMK AO2 SLP085 T01890083 $',
    r'METAR KGTF 231853Z KT 10SM CLR 24/05 A2976 RMK AO2 SLP055 T02390050 $',
    r'METAR KGTF 251953Z KT 10SM CLR 20/05 A3008 RMK AO2 SLP175 T02000050',
    r'METAR KGTF 282053Z KT 10SM CLR 22/04 A3013 RMK AO2 SLP188 T02170039 56009 $',
    r'METAR KGTF 292153Z KT 10SM CLR 27/M02 A2995 RMK AO2 SLP125 T02671022 $',
    r'METAR KGTF 012053Z KT 10SM CLR 22/M05 A2986 RMK AO2 SLP099 T02221050 56006 $',
    r'METAR KGTF 071453Z KT 10SM CLR 16/04 A3020 RMK AO2 SLP211 T01560039 51012 $',
    r'METAR KGTF 071853Z KT 10SM CLR 24/02 A3020 RMK AO2 SLP208 T02440017 $',
    r'METAR KGTF 071953Z KT 10SM CLR 26/03 A3019 RMK AO2 SLP202 T02560028 $',
    r'METAR KGTF 132053Z KT 10SM FEW060 FEW095 22/04 A3003 RMK AO2 SLP157 T02170044 58013 $',
    r'METAR KGTF 132153Z KT 10SM CLR 22/04 A3002 RMK AO2 SLP153 T02170044 $',
    r'SPECI KGTF 140210Z KT 1 3/4SM +RA SCT040 BKN075 OVC100 15/07 A3003 RMK AO2 TWR VIS 10 RAB02 P0009 T01500067 $',
    r'METAR KGTF 142053Z KT 10SM CLR 23/01 A2998 RMK AO2 SLP141 T02280006 56024',
    r'METAR KGTF 162153Z KT 10SM CLR 13/01 A3004 RMK AO2 SLP177 T01280011',
    r'METAR KGTF 281853Z KT 10SM CLR 18/04 A2971 RMK AO2 SLP041 T01830039',
    r'METAR KGTF 121853Z KT 10SM OVC100 04/M06 A3010 RMK AO2 SLP231 T00391061',
    r'METAR KGTF 181153Z KT 10SM CLR 07/M05 A2974 RMK',
    r'METAR KGTF 071853Z KT 10SM BKN120 07/M02 A2973 RMK AO2 SLP104 T00671022 $',
    r'SPECI KGTF 200813Z KT 10SM FEW020 SCT050 M13/M16 A3015 RMK AO2 T11331156 $',
    r'SPECI KGTF 291651Z KT 1SM -SN BR FEW007 BKN015 M23/M25 A2979 RMK AO2 TWR VIS 3 SNB48 P0000 $ FIBI',
    r'METAR KGTF 291653Z KT 1SM -SN BR SCT007 OVC015 M23/M26 A2980 RMK AO2 TWR VIS 3 SNB48 SLP191 P0000 T12331256 $',
    r'SPECI KGTF 291658Z KT 1 3/4SM -SN BKN007 OVC015 M23/M26 A2980 RMK AO2 TWR VIS 3 P0000 T12281256 $',
    r'SPECI KGTF 291701Z KT 3SM BR BKN007 OVC015 M23/M25 A2979 RMK AO2 SNE1659 P0000 T12281250 $',
    r'SPECI KGTF 291712Z KT 2SM HZ BKN003 BKN007 OVC015 M23/M26 A2979 RMK AO2 TWR VIS 5 SNE1659 P0000 T12281256 $',
    r'METAR KGTF 311853Z KT 10SM CLR M21/M26 A2989 RMK AO2 SLP219 T12111256 $',
    // Unrecognizable wind group values before 'KT' keyword in Body section
    r'METAR KGTF 162253Z 230 KT 10SM CLR 22/M03 A3001 RMK',
    // Wrongly formatted input, handled correctly by logic (collided temperature/dew point and altimeter)
    r'SPECI KGTF 111350Z 24005KT 6SM -SN BKN022 BKN075 OVC090 M34/A3044 RMK AO2 SNE02B49 P0000',
    r'METAR KGTF 111353Z 23005KT 4SM -SN BKN022 OVC085 M35/A3044 RMK AO2 SNE02B49 SLP456 P0000 T1350',
    r'METAR KGTF 111453Z 23007KT 10SM BKN035 OVC085 M34/A3046 RMK AO2 SNE40 SLP458 P0000 60001 T1344 53006',
    r'METAR KGTF 120553Z 23011KT 10SM CLR M34/A3036 RMK AO2 SLP428 T1344 11294 21344 56009 $',
    r'METAR KGTF 120653Z 21009KT 10SM CLR M34/A3036 RMK AO2 SLP426 T1344 412671350 $',
    r'METAR KGTF 120853Z 22008KT 10SM CLR M34/A3034 RMK AO2 SLP415 T1344 58008 $',
    r'METAR KGTF 120953Z 21007KT 10SM CLR M36/A3033 RMK AO2 SLP411 T1356 $',
    r'METAR KGTF 121153Z 23007KT 10SM CLR M36/A3029 RMK AO2 SLP403 70001 T1356 11333 21361 58015 $',
    // Unrecognizable symbols in Body section
    r'METAR KGTF 260953Z 24007KT 10SM CLR 1 A3015 RMK AO2 SLP190 T01110089 $',
    r'METAR KGTF 261553Z 36015G21KT 10SM CLR 2 gf 6//21 A3023 RMK AO2 SLP207 T02500094 $',
    r'METAR KGTF 261853Z 36015G23KT b i T d 8/08 A3023 RMK AO2 PK WND 01027/1758 SLP206 T02780083 $',
    r'METAR KGTF 262353Z 35013G22KT 10SM B S 27/08 A3019 RMK AO2 SLP198 T02720078 10300 20250 58007 $',
  ];

  const metars = <String, List<String>>{
    '2021_KATL': katl2021,
    '2021_KGTF': kgtf2021,
  };
  return metars[key] ?? <String>[];
}
